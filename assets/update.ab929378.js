var he=Object.defineProperty;var ye=(e,r,t)=>r in e?he(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var y=(e,r,t)=>(ye(e,typeof r!="symbol"?r+"":r,t),t);function xe(e,r){return{x:e.x+r.x,y:e.y+r.y}}function se(e,r){return{x:e.x-r.x,y:e.y-r.y}}const ge=(e,r)=>Math.sqrt((e.x-r.x)*(e.x-r.x)+(e.y-r.y)*(e.y-r.y)),me=(e,r)=>ge(e.pos,r.pos)<e.radius+r.radius,Me=(e,r)=>!(e.pos.x+e.radius<r.pos.x-r.radius||e.pos.y+e.radius<r.pos.y-r.radius||e.pos.x-e.radius>r.pos.x+r.radius||e.pos.y-e.radius>r.pos.y+r.radius),W=(e,r)=>e>0?e>=r?r:e:e<=-r?-r:e,Se=e=>({x:W(e.vel.x,e.maxVel.x),y:W(e.vel.y,e.maxVel.y)}),O=e=>({radius:e.radius||4,color:e.color||"black",outlineColor:e.outlineColor,strokeColor:e.strokeColor,pos:e.pos||{x:0,y:0},posOffset:e.posOffset||{x:0,y:0},vel:e.vel||{x:0,y:0},maxVel:e.maxVel||{x:0,y:0},acel:e.acel||{x:0,y:0}}),Ee=e=>O({radius:5,color:"white",outlineColor:"black",pos:e,maxVel:{x:3,y:3},acel:{x:.4,y:.4}}),be=(e,r)=>Me(e,r)&&me(e,r),ke=e=>{e.vel.y+=e.acel.y,e.vel.x+=e.acel.x},oe=e=>{e.vel=Se(e),e.pos=xe(e.pos,e.vel)},we=(e,r)=>{r.up&&(e.vel.y-=e.acel.y),r.down&&(e.vel.y+=e.acel.y),r.left&&(e.vel.x-=e.acel.x),r.right&&(e.vel.x+=e.acel.x),oe(e)},Ce=(e,r)=>{e.pos=se(r.pos,e.posOffset)},b=(e,r)=>{e.pos.y>r.y?e.pos.y-=r.y:e.pos.y<0&&(e.pos.y+=r.y),e.pos.x>r.x?e.pos.x-=r.x:e.pos.x<0&&(e.pos.x+=r.x)},F=(e,r)=>Math.floor(Math.random()*(r-e+1)+e),m=document.getElementById("canvas"),u=m.getContext("2d"),qe={thisIsYou:document.getElementById("imgthisIsYou")},Ae=()=>({x:window.innerWidth,y:window.innerHeight}),Ke=()=>({x:window.innerWidth/2,y:window.innerHeight/2}),Pe=()=>Math.random()>=.5?{x:F(0,window.innerWidth),y:0}:{x:0,y:F(0,window.innerHeight)},Ie=()=>{m.width=window.innerWidth,m.height=window.innerHeight},Le=()=>{m.style.display="none"},Re=(e,r,t)=>{u.drawImage(qe[e],r,t)},Y=e=>{u.fillStyle=e.color,u.beginPath(),u.arc(e.pos.x,e.pos.y,e.radius,0,2*Math.PI),u.fill()},Be=e=>{var r;u.fillStyle=e.color,u.strokeStyle=(r=e.strokeColor)!=null?r:"",u.beginPath(),u.arc(e.pos.x,e.pos.y,e.radius,0,2*Math.PI),u.fill(),u.stroke()},He=()=>{u.fillStyle="white",u.fillRect(0,0,m.width,m.height)};var ie={exports:{}},Te=function(e,r,t){var n=this;return e=e instanceof Array?e:[e],n.bindMultiple(e,r,t),n},_e=function(e,r,t){for(var n=this,s=0;s<e.length;++s)n.bindSingle(e[s],r,t)},Fe=function(e,r){var t=this;return t.bind(e,function(){},r)},De=function(e,r){var t=this;return t.directMap[e+":"+r]&&t.directMap[e+":"+r]({},e),this},Oe=function(){var e=this;return e.callbacks={},e.directMap={},this},$e=function(e,r){if((" "+r.className+" ").indexOf(" combokeys ")>-1)return!1;var t=r.tagName.toLowerCase();return t==="input"||t==="select"||t==="textarea"||r.isContentEditable},k,N;function $(){return N||(N=1,k=function(e){return e==="shift"||e==="ctrl"||e==="alt"||e==="meta"}),k}var Ve=function(e,r,t){var n=this,s,o,a={},i=0,c=!1,f,l;for(s=n.getMatches(e,r,t),o=0;o<s.length;++o)s[o].seq&&(i=Math.max(i,s[o].level));for(o=0;o<s.length;++o){if(s[o].seq){if(s[o].level!==i)continue;c=!0,a[s[o].seq]=1,n.fireCallback(s[o].callback,t,s[o].combo,s[o].seq);continue}c||n.fireCallback(s[o].callback,t,s[o].combo)}l=t.type==="keypress"&&n.ignoreNextKeypress,f=$(),t.type===n.nextExpectedAction&&!f(e)&&!l&&n.resetSequences(a),n.ignoreNextKeypress=c&&t.type==="keydown"},S={exports:{}};S.exports=ae;S.exports.on=ae;S.exports.off=We;function ae(e,r,t,n){return!e.addEventListener&&(r="on"+r),(e.addEventListener||e.attachEvent).call(e,r,t,n),t}function We(e,r,t,n){return!e.removeEventListener&&(r="on"+r),(e.removeEventListener||e.detachEvent).call(e,r,t,n),t}var w={exports:{}},G;function ce(){return G||(G=1,function(e){e.exports={8:"backspace",9:"tab",13:"enter",16:"shift",17:"ctrl",18:"alt",20:"capslock",27:"esc",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down",45:"ins",46:"del",91:"meta",93:"meta",173:"minus",187:"plus",189:"minus",224:"meta"};for(var r=1;r<20;++r)e.exports[111+r]="f"+r;for(r=0;r<=9;++r)e.exports[r+96]=r}(w)),w.exports}var C,J;function Ye(){return J||(J=1,C={106:"*",107:"plus",109:"minus",110:".",111:"/",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"}),C}var q,Q;function le(){return Q||(Q=1,q=function(e){var r,t;if(r=ce(),t=Ye(),e.type==="keypress"){var n=String.fromCharCode(e.which);return e.shiftKey||(n=n.toLowerCase()),n}return r[e.which]!==void 0?r[e.which]:t[e.which]!==void 0?t[e.which]:String.fromCharCode(e.which).toLowerCase()}),q}var A,U;function Ne(){return U||(U=1,A=function(e){var r=[];return e.shiftKey&&r.push("shift"),e.altKey&&r.push("alt"),e.ctrlKey&&r.push("ctrl"),e.metaKey&&r.push("meta"),r}),A}var K,X;function Ge(){return X||(X=1,K=function(e){var r=this,t,n;typeof e.which!="number"&&(e.which=e.keyCode),t=le();var s=t(e);if(s!==void 0){if(e.type==="keyup"&&r.ignoreNextKeyup===s){r.ignoreNextKeyup=!1;return}n=Ne(),r.handleKey(s,n(e),e)}}),K}var Je=function(){var e=this,r=S.exports,t=e.element;e.eventHandler=Ge().bind(e),r(t,"keypress",e.eventHandler),r(t,"keydown",e.eventHandler),r(t,"keyup",e.eventHandler)},Qe=function(e,r,t,n,s){var o=this;o.directMap[e+":"+t]=r,e=e.replace(/\s+/g," ");var a=e.split(" "),i;if(a.length>1){o.bindSequence(e,a,r,t);return}i=o.getKeyInfo(e,t),o.callbacks[i.key]=o.callbacks[i.key]||[],o.getMatches(i.key,i.modifiers,{type:i.action},n,e,s),o.callbacks[i.key][n?"unshift":"push"]({callback:r,modifiers:i.modifiers,action:i.action,seq:n,level:s,combo:e})},P,Z;function Ue(){return Z||(Z=1,P=function(e){return e==="+"?["+"]:e.split("+")}),P}var I,j;function Xe(){return j||(j=1,I={option:"alt",command:"meta",return:"enter",escape:"esc",mod:/Mac|iPod|iPhone|iPad/.test(navigator.platform)?"meta":"ctrl"}),I}var L,z;function Ze(){return z||(z=1,L={"~":"`","!":"1","@":"2","#":"3",$:"4","%":"5","^":"6","&":"7","*":"8","(":"9",")":"0",_:"-","+":"=",":":";",'"':"'","<":",",">":".","?":"/","|":"\\"}),L}var je=function(e,r){var t=this,n,s,o,a,i=[],c,f,l;for(n=Ue(),s=n(e),c=Xe(),f=Ze(),l=$(),a=0;a<s.length;++a)o=s[a],c[o]&&(o=c[o]),r&&r!=="keypress"&&f[o]&&(o=f[o],i.push("shift")),l(o)&&i.push(o);return r=t.pickBestAction(o,i,r),{key:o,modifiers:i,action:r}},ze=function(e,r,t){var n=this;return t||(t=n.getReverseMap()[e]?"keydown":"keypress"),t==="keypress"&&r.length&&(t="keydown"),t},er=function(){var e=this,r=e.constructor,t;if(!r.REVERSE_MAP){r.REVERSE_MAP={},t=ce();for(var n in t)n>95&&n<112||t.hasOwnProperty(n)&&(r.REVERSE_MAP[t[n]]=n)}return r.REVERSE_MAP},R,ee;function rr(){return ee||(ee=1,R=function(e,r){return e.sort().join(",")===r.sort().join(",")}),R}var tr=function(e,r,t,n,s,o){var a=this,i,c,f=[],l=t.type,M,V;if(l==="keypress"&&!(t.code&&t.code.slice(0,5)==="Arrow")){var ue=a.callbacks["any-character"]||[];ue.forEach(function(ve){f.push(ve)})}if(!a.callbacks[e])return f;for(M=$(),l==="keyup"&&M(e)&&(r=[e]),i=0;i<a.callbacks[e].length;++i)if(c=a.callbacks[e][i],!(!n&&c.seq&&a.sequenceLevels[c.seq]!==c.level)&&l===c.action&&(V=rr(),l==="keypress"&&!t.metaKey&&!t.ctrlKey||V(r,c.modifiers))){var pe=!n&&c.combo===s,de=n&&c.seq===n&&c.level===o;(pe||de)&&a.callbacks[e].splice(i,1),f.push(c)}return f},nr=function(e){var r=this;e=e||{};var t=!1,n;for(n in r.sequenceLevels){if(e[n]){t=!0;continue}r.sequenceLevels[n]=0}t||(r.nextExpectedAction=!1)},B,re;function sr(){return re||(re=1,B=function(e){if(e.preventDefault){e.preventDefault();return}e.returnValue=!1}),B}var H,te;function or(){return te||(te=1,H=function(e){if(e.stopPropagation){e.stopPropagation();return}e.cancelBubble=!0}),H}var ir=function(e,r,t,n){var s=this,o,a;s.stopCallback(r,r.target||r.srcElement,t,n)||e(r,t)===!1&&(o=sr(),o(r),a=or(),a(r))},ar=function(e,r,t,n){var s=this;s.sequenceLevels[e]=0;function o(l){return function(){s.nextExpectedAction=l,++s.sequenceLevels[e],s.resetSequenceTimer()}}function a(l){var M;s.fireCallback(t,l,e),n!=="keyup"&&(M=le(),s.ignoreNextKeyup=M(l)),setTimeout(function(){s.resetSequences()},10)}for(var i=0;i<r.length;++i){var c=i+1===r.length,f=c?a:o(n||s.getKeyInfo(r[i+1]).action);s.bindSingle(r[i],f,n,e,i)}},cr=function(){var e=this;clearTimeout(e.resetTimer),e.resetTimer=setTimeout(function(){e.resetSequences()},1e3)},T=S.exports.off,lr=function(){var e=this,r=e.element;T(r,"keypress",e.eventHandler),T(r,"keydown",e.eventHandler),T(r,"keyup",e.eventHandler)},fr=function(){var e=this;e.instances.forEach(function(r){r.reset()})};(function(e){e.exports=function(r,t){var n=this,s=n.constructor;return n.options=Object.assign({storeInstancesGlobally:!0},t||{}),n.callbacks={},n.directMap={},n.sequenceLevels={},n.resetTimer=null,n.ignoreNextKeyup=!1,n.ignoreNextKeypress=!1,n.nextExpectedAction=!1,n.element=r,n.addEvents(),n.options.storeInstancesGlobally&&s.instances.push(n),n},e.exports.prototype.bind=Te,e.exports.prototype.bindMultiple=_e,e.exports.prototype.unbind=Fe,e.exports.prototype.trigger=De,e.exports.prototype.reset=Oe,e.exports.prototype.stopCallback=$e,e.exports.prototype.handleKey=Ve,e.exports.prototype.addEvents=Je,e.exports.prototype.bindSingle=Qe,e.exports.prototype.getKeyInfo=je,e.exports.prototype.pickBestAction=ze,e.exports.prototype.getReverseMap=er,e.exports.prototype.getMatches=tr,e.exports.prototype.resetSequences=nr,e.exports.prototype.fireCallback=ir,e.exports.prototype.bindSequence=ar,e.exports.prototype.resetSequenceTimer=cr,e.exports.prototype.detach=lr,e.exports.instances=[],e.exports.reset=fr,e.exports.REVERSE_MAP=null})(ie);const ur=ie.exports,h=new ur(document.documentElement),p={up:!1,down:!1,left:!1,right:!1};h.bind("up",()=>{p.up=!0},"keydown");h.bind("up",()=>{p.up=!1},"keyup");h.bind("down",()=>{p.down=!0},"keydown");h.bind("down",()=>{p.down=!1},"keyup");h.bind("left",()=>{p.left=!0},"keydown");h.bind("left",()=>{p.left=!1},"keyup");h.bind("right",()=>{p.right=!0},"keydown");h.bind("right",()=>{p.right=!1},"keyup");class pr{constructor(){y(this,"avoiding",!0);y(this,"finished",!1);y(this,"hasMoved",!1)}}const v=new pr,E={scoreBoards:document.getElementById("scoreBoards"),avoidingSeconds:document.getElementById("secondsAvoided"),secondsLeft:document.getElementById("secondsLeft"),amountCollected:document.getElementById("amountCollected")};class dr{constructor(){y(this,"avoidingSeconds",0);y(this,"secondsLeft",20);y(this,"amountCollected",0)}}const x=new dr,fe=()=>{E.avoidingSeconds.innerHTML=x.avoidingSeconds.toString(),E.secondsLeft.innerHTML=x.secondsLeft.toString(),E.amountCollected.innerHTML=x.amountCollected.toString()},vr=()=>{E.scoreBoards.style.display="none"},hr=()=>`#${Math.random().toString(16).substr(-6)}`,D=[],d=[];let _=-1;Ie();const g=Ee(Ke()),ne=e=>{for(let r=0,t=d.length;r<t;r++)if(d[r]&&be(e,d[r])){const n=d[r];D.push(O({radius:n.radius,color:n.color,pos:n.pos,posOffset:se(g.pos,n.pos)})),d.splice(r,1),v.avoiding&&(v.avoiding=!1,document.getElementById("avoidBoard").style.opacity="0.25",document.getElementById("collectBoard").style.display="block"),x.amountCollected++,fe()}},yr=()=>{vr(),Le(),document.getElementById("menuContainer").style.display="none",document.getElementById("finish").style.display="block"},xr=()=>{He();const e=Ae();v.hasMoved||(Re("thisIsYou",e.x/2-70,e.y/2-123),(p.up||p.down||p.left||p.right)&&(v.hasMoved=!0));for(let r=0;r<d.length;r++)if(d[r]){const t=d[r];oe(t),ke(t),b(t,e),Y(t)}we(g,p),b(g,e),Be(g),ne(g);for(let r=0;r<D.length;r++){const t=D[r];Ce(t,g),b(t,e),Y(t),ne(t)}v.finished||window.requestAnimationFrame(xr)},gr=()=>{_++,v.hasMoved&&(v.avoiding?x.avoidingSeconds++:(x.secondsLeft--,x.secondsLeft<=0&&(v.finished=!0)),fe(),d.length<=130&&d.push(O({radius:F(7,14),color:hr(),pos:Pe(),maxVel:{x:Math.random()*_/7+1,y:Math.random()*_/7+1},acel:{x:Math.random()<.5?-.005:.005,y:Math.random()<.5?-.005:.005}}))),v.finished?yr():setTimeout(gr,1e3)};export{xr as renderLoop,gr as secondsLoop};
